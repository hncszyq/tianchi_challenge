# A Data-Centric Approach for Model Robustness  

This repository contains the code for participating in the [data-centric robust learning competition](https://tianchi.aliyun.com/competition/entrance/531939/introduction) hosted by Alibaba Group and Tsinghua University in the AAAI2022 workshop on adversarial machine learning and beyond. 

 - Our paper: [Exploiting the Potential of Datasets: A Data-Centric Approach for Model Robustness](https://arxiv.org/abs/2203.05323).

## Structure
```text
├── cifar10           // CIFAR-10 training set and testing set
│   ├── test_data.npy
│   ├── test_label.npy
│   ├── train_data.npy
│   └── train_label.npy
├── models            // model structures and trained model parameters
│   ├── trained
│   │   ├── densenet121.pth.tar
│   │   ├── mobilenetv2.pth.tar
│   │   ├── resnet50.pth.tar
│   │   ├── vgg16.pth.tar
│   │   └── wideresnet.pth.tar
│   ├── __init__.py
│   ├── densenet.py
│   ├── resnet.py
│   └── wideresnet.py
├── delta_l2.npy       // adversarial perturbations generated by gen_delta_l2.py
├── delta_linf.npy     // adversarial perturbations generated by gen_delta_linf.py
├── gen_dataset.py     // generated the enhanced dataset
├── gen_delta_l2.py    // generated l2-bounded transferable adversarial perturbations
├── gen_delta_linf.py  // generated linf-bounded transferable adversarial perturbations
└── README.md
```

## Usage

- **Dataset and trained models:**  
  You should first download [the CIFAR10 dataset](https://drive.google.com/file/d/1tnsGCGihUKnlOIngY0lzkvaF3VH_Qaxl/view?usp=sharing) and [our trained models](https://drive.google.com/file/d/1eAV73ey15qYMEXx0IHIZ0fQZSxAxwiqB/view?usp=sharing) and place them in cifar10/ and models/trained/, repectively.

- **Generate the enhanced dataset:**  
  Note: before running gen_dataset.py, you should first make sure that delta_l2.npy and delta_linf.npy have been generated by running gen_delta_l2.py and gen_delta_linf.py.
  ```Shell
  $ python3 gen_dataset.py
  ```
 
- **Generate linf-bounded transferable adversarial perturbations:**
  ```Shell
  $ python3 gen_delta_linf.py
  ```
 
- **Generated l2-bounded transferable adversarial perturbations:**
  ```Shell
  $ python3 gen_delta_l2.py
  ```

## Acknowledgments
  Code refers to [https://github.com/ZhengyuZhao/Targeted-Tansfer](https://github.com/ZhengyuZhao/Targeted-Tansfer).